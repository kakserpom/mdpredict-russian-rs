# mdpredict-russian-rs

**Mental Disorder Prediction** — предсказание психических расстройств на основе структурных характеристик письменной речи на русском языке.

## Описание

Инструмент реализует методологию из научной статьи:

> **«Диагностическое значение структурных характеристик письменной речи пациентов с шизофренией»**
> Смерчинская Э.М., Трегубенко И.А., Исаева Е.Р.
> Национальный психологический журнал. 2026. Т. 21, № 1, С. 30–43
> https://doi.org/10.11621/npj.2026.0103

Исследование показало, что анализ структурных характеристик письменной речи позволяет:
- Отличать тексты пациентов с шизофренией от текстов здоровых лиц с точностью **92%**
- Дифференцировать шизофрению от других психических расстройств с точностью **70%**

## Установка

```bash
git clone <repository>
cd mdpredict-russian
cargo build --release
```

## Использование

### Интерактивный режим

```bash
mdpredict
```

Введите текст для анализа, затем пустую строку для получения результата.

### Анализ файла

```bash
mdpredict text.txt
```

### JSON-вывод

```bash
mdpredict --json text.txt
```

### Демонстрация

```bash
mdpredict --demo
```

Запускает анализ примеров из оригинальной статьи.

## Анализируемые метрики

Согласно методологии статьи, анализатор вычисляет 19+ структурных характеристик:

### Структура предложений
| Параметр | Описание |
|----------|----------|
| Простые предложения | Одна грамматическая основа |
| Сложносочинённые | Части связаны сочинительными союзами (и, а, но) |
| Сложноподчинённые | Части связаны подчинительными союзами (что, когда, если) |
| Бессоюзные | Части без союзной связи |

### Глагольные характеристики
| Параметр | Описание |
|----------|----------|
| Внешние предикаты | Глаголы внешних действий («иду», «говорят») |
| Внутренние предикаты | Глаголы внутренних состояний («думаю», «чувствую») |
| Глаголы прошедшего времени | «шёл», «думал», «видел» |
| Глаголы настоящего времени | «иду», «думаю», «вижу» |
| Глаголы будущего времени | «пойду», «подумаю» |
| Инфинитивы | «идти», «думать», «видеть» |
| Отглагольные формы | Причастия и деепричастия |

### Местоимения
| Параметр | Описание |
|----------|----------|
| 1-е лицо ед.ч. | я, меня, мне, мной |
| 1-е лицо мн.ч. | мы, нас, нам, нами |
| 2-е лицо ед.ч. | ты, тебя, тебе |
| 2-е лицо мн.ч. | вы, вас, вам |
| 3-е лицо ед.ч. | он, она, оно, его, её |
| 3-е лицо мн.ч. | они, их, им |

### Специальные индексы
| Параметр | Описание |
|----------|----------|
| Индекс лексического разнообразия | Уникальные слова / Общее количество × 100 |
| Индекс эмболии | Слова-паразиты («ну», «вот», «короче») |
| Индекс водности | Незначимые слова / Общее количество |
| Индекс эгоцентризма | Местоимения «Я» и производные |
| Слова социального взаимодействия | Конструкции с «мы», глаголы 1 л. мн.ч. |
| Слова эмоций | «весело», «грустно», «страх» и т.п. |

## Ключевые диагностические показатели

### Шизофрения vs Здоровые (точность 92%)

| Показатель | При шизофрении |
|------------|----------------|
| Внешние предикаты | ↑ Повышены |
| Глаголы прошедшего времени | ↑ Повышены |
| Глаголы настоящего времени | ↓ Снижены |
| Слова эмоций | ↓ Снижены |
| Объём текста | ↓ Снижен |

### Дифференциальная диагностика (точность 70%)

| Показатель | Шизофрения | БАР | РЛ |
|------------|------------|-----|-----|
| Сложносочинённые предложения | ↑ | ↓ | ↓ |
| Отглагольные формы | ↓ | ↑ | — |
| Местоимения 1 л. ед.ч. | ↓ | ↑ | ↑ |

## Структура проекта

```
src/
├── lib.rs          # Основная библиотека
├── main.rs         # CLI-интерфейс
├── metrics.rs      # Структура метрик текста
├── dictionaries.rs # Словари русского языка
├── morphology.rs   # Базовый морфологический анализатор
├── rsmorph.rs      # Морфологический анализатор на базе rsmorphy (OpenCorpora)
├── sentence.rs     # Анализатор предложений
├── analyzer.rs     # Основной анализатор
└── classifier.rs   # LDA-классификатор
```

## Использование как библиотеки

```rust
use mdpredict_russian::{TextAnalyzer, Classifier};

let analyzer = TextAnalyzer::new();
let classifier = Classifier::new();

let text = "Я помню как катался на велосипеде и упал.";
let metrics = analyzer.analyze(text);
let result = classifier.classify(&metrics);

println!("Классификация: {}", result.primary_diagnosis);
println!("Уверенность: {:.1}%", result.confidence * 100.0);
```

## Примеры из статьи

### Текст пациента с шизофренией
> «Как я катался на 3-колёсном велосипеде и упал. 3–4 года»

Характеристики: короткий текст (9 слов), прошедшее время (22%), внешние предикаты, минимум эмоций.

**Результат классификации: Шизофрения (84.3%)**

### Текст психически здорового человека
> «Ко мне подходит мама, склоняется надо мной и просит поднять руки. Я поднимаю руки и на меня натягивается блузка с короткими рукавами-фонариками. Кофточка из прозрачного плохо тянущегося материала отделана блестящим люрексом сильно колется. Но ничего, я потерплю.»

Характеристики: длинный текст (47 слов), настоящее время (15%), эмоциональное описание, детализация.

**Результат классификации: Психически здоровые лица (65.5%)**

### Точность на примерах из статьи

| Пример | Ожидаемый результат | Классификация | Уверенность |
|--------|---------------------|---------------|-------------|
| 1 | Шизофрения | ✓ Шизофрения | 85.1% |
| 2 | Здоровые | ✓ Здоровые | 71.1% |
| 3 | Расстройство личности | ✓ Расстройство личности | 59.9% |
| 4 | Биполярное | ✓ Биполярное | 90.5% |

Точность: **4/4 (100%)** на примерах из статьи.

## Тестирование

```bash
cargo test
```

## Технические детали

### Морфологический анализ

Используется библиотека [rsmorphy](https://crates.io/crates/rsmorphy) — Rust-порт pymorphy2 со словарём OpenCorpora (389 000+ лемм). Это обеспечивает:
- Точное определение частей речи
- Лемматизацию (приведение к начальной форме)
- Определение грамматических характеристик (время, лицо, число)

### Классификатор

Реализован классификатор на основе Linear Discriminant Analysis (LDA):
- Дискриминантные функции для каждой диагностической группы
- Softmax-преобразование для получения вероятностей
- Коэффициенты настроены на основе референтных значений из статьи (Таблица 2)

### Сегментация текста

Используется [unicode-segmentation](https://crates.io/crates/unicode-segmentation) для корректного разбиения текста на слова согласно Unicode Standard Annex #29.

## Ограничения

1. **Классификатор** использует приближённые коэффициенты LDA (точные коэффициенты не опубликованы в статье)
2. **Словари предикатов** могут не покрывать все глагольные формы
3. **Точность** на реальных данных может отличаться от заявленной в статье (92% для шизофрения/норма, 70% для дифференциальной диагностики)
4. **Текст должен быть** на русском языке, описывать раннее воспоминание (методика исследования)

## Важное предупреждение

> **Данный инструмент предназначен ТОЛЬКО для исследовательских целей.**
>
> Он **НЕ является** заменой профессиональной медицинской диагностики.
> Результаты анализа носят вероятностный характер и не могут служить
> основанием для постановки диагноза.
>
> Для диагностики психических расстройств обратитесь к квалифицированному
> специалисту — врачу-психиатру.

## Лицензия

MIT

## Ссылки

- [Оригинальная статья](https://doi.org/10.11621/npj.2026.0103)
- [Национальный психологический журнал](https://npsyj.ru)

## Авторы методологии

- Смерчинская Э.М. — ПСПбГМУ им. И.П. Павлова, НМИЦ ПН им. В.М. Бехтерева
- Трегубенко И.А. — ПСПбГМУ им. И.П. Павлова, РГПУ им. А.И. Герцена
- Исаева Е.Р. — ПСПбГМУ им. И.П. Павлова
